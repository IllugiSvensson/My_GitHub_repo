#!/bin/bash



#–ü–†–û–í–ï–†–ö–ê –£–¢–ò–õ–ò–¢
for i in realpath zenity date whoami pkexec curl xdg-open
do

	$i --help >/dev/null 2>&1
	[ $? == 0 ] || {

		echo -e "\n–£—Ç–∏–ª–∏—Ç–∞ $i –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —É—Ç–∏–ª–∏—Ç—É\n"
		zenity --error --title="GetStand" --ellipsize --text="–£—Ç–∏–ª–∏—Ç–∞ $i –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞\n–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —É—Ç–∏–ª–∏—Ç—É"
		exit

	}

done



#–ù–ï–û–ë–•–û–î–ò–ú–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï
appfolder=`realpath $0`
appfolder=${appfolder%/Install/Setup_Linux}
icon="$appfolder/App/ChromePortable"
app="$appfolder/App/httpN"
userName=`whoami`
#–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ —Ñ—É–Ω–∫—Ü–∏–π
. $appfolder/App/httpN/httpN_Linux_lib





#–ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–¨–°–ö–ò–ï –§–£–ù–ö–¶–ò–ò
function CreateAccount {					#–§—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –∞–∫–∫–∞—É–Ω—Ç–∞

	test_input=`echo "$input" | egrep -o "[–∞-—è–ê-–Ø]{1,}\s{1,}[–∞-—è–ê-–Ø]{1,}\(\w+\)"`
	if [ "$input" != "$test_input" ]		#–ß–∏—Ç–∞–µ–º –≤–≤–æ–¥ –∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ —à–∞–±–ª–æ–Ω—É
	then

		zenity --error --title="–û—à–∏–±–∫–∞" --window-icon="$icon/install.png" --text="–û—à–∏–±–∫–∞ –≤ –∑–∞–ø–∏—Å–∏ –∏–º–µ–Ω–∏\n–í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –ø–æ —à–∞–±–ª–æ–Ω—É" --ellipsize --timeout=5
		return 1	#–í—ã—Ö–æ–¥–∏–º –æ–±—Ä–∞—Ç–Ω–æ –≤ —Ü–∏–∫–ª

	else

		[ -e "/home/$userName/" ] || {				#–ï—Å–ª–∏ –∏–º—è –∏–ª–∏ –∫–∞—Ç–∞–ª–æ–≥ –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–∏–ª—Å—è

			message=`echo -e "üõë<b>–ò–º—è –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ</b>\n‚ùå$input\n‚è±$(_Now)"`
			BotMsg "$message" 0
			message=`printf "%-19s" "$(_Now) | –ò–º—è –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∞–¥—Ä–µ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: $input"`
			echo -e	"$message" >> "$appfolder/App/httpN/system/log/system.txt"
			zenity --error --title="–û—à–∏–±–∫–∞" --window-icon="$icon/install.png" --ellipsize --text="–ò–º—è –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ\n–û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ –û—Ç–¥–µ–ª –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è" --timeout=5
			exit

		}

		#–°–æ–∑–¥–∞–µ–º –∑–∞–ø–∏—Å–∏ –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è URL
		touch /home/$userName/.local/share/applications/httpn.desktop	#–°–æ–∑–¥–∞–µ–º —Ñ–∞–π–ª–∏–∫
		cd /home/$userName/.local/share/applications/
		echo "[Desktop Entry]" > httpn.desktop							#–ó–∞–ø–æ–ª–Ω—è–µ–º –Ω—É–∂–Ω—ã–º–∏ –∫–æ–º–∞–Ω–¥–∞–º–∏
		echo "Type=Application" >> httpn.desktop
		echo "Name=httpN_Linux" >> httpn.desktop
		echo "Icon=$icon/GetStand.png" >> httpn.desktop
		echo "Exec=$app/httpN_Linux %u" >> httpn.desktop
		echo "Terminal=false" >> httpn.desktop
		echo "StartupNotify=true" >> httpn.desktop
		echo "MimeType=x-scheme-handler/httpn" >> httpn.desktop
		pkexec mv /home/$userName/.local/share/applications/httpn.desktop /usr/share/applications/
		xdg-mime default httpn.desktop x-scheme-handler/httpn			#–†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
		[ `xdg-mime query default x-scheme-handler/httpn` == "httpn.desktop" ] || {	#–ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–±–æ—Ç—É

			zenity --error --title="–û—à–∏–±–∫–∞" --ellipsize --text="–û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å—Ö–µ–º—ã –Ω–µ –Ω–∞–∑–Ω–∞—á–µ–Ω\n–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –Ω–∞–∑–Ω–∞—á–∏—Ç—å –≤—Ä—É—á–Ω—É—é:\n\n–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª /home/$userName/share/applications/httpn.desktop\n[Desktop Entry]\nType=Application\nName=httpN_Linux\nExec=$app/httpN_Linux %u\nTerminal=false\nMimeType=x-scheme-handler/httpn\n\n–ó–∞—Ç–µ–º –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:\nxdg-mime default httpn.desktop x-scheme-handler/httpn"
			return 1

		}

		#–î–µ–ª–∞–µ–º –∑–∞–ø–∏—Å—å –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ –∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º
		echo -e "\n$userName $input default" >> "$appfolder/App/httpN/system/USERS"
		stringlen=`cat $appfolder/App/httpN/system/USERS | grep "$input"`
		[ -z "$stringlen" ] && {

			message=`echo -e "üõë<b>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω</b>\n‚ùå$input\n‚è±$(_Now)"`
			BotMsg "$message" 0
			message=`printf "%-19s" "$(_Now) | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∞–¥—Ä–µ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: $input"`
			echo -e	"$message" >> "$appfolder/App/httpN/system/log/system.txt"
			zenity --error --title="–û—à–∏–±–∫–∞" --window-icon="$icon/install.png" --ellipsize --text="–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è\n–û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ –û—Ç–¥–µ–ª –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è" --timeout=5
			exit

		}

			message=`echo -e "‚úÖ<b>–ù–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–±–∞–≤–ª–µ–Ω</b>\nüë§$input üêßLinux\n‚è±$(_Now)"`
			BotMsg "$message" 0
			message=`printf "%-19s" "$(_Now) | –î–æ–±–∞–≤–ª–µ–Ω –Ω–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å Linux: $input"`
			echo -e	"$message" >> "$appfolder/App/httpN/system/log/system.txt"

			#–°–æ–∑–¥–∞–µ–º —è—Ä–ª—ã–∫ —Å—Ö–µ–º—ã
			touch /home/$userName/.local/share/applications/GetStand.desktop
			echo "[Desktop Entry]" > GetStand.desktop
			echo "Name=GetStand" >> GetStand.desktop
			echo "Exec=/usr/bin/xdg-open $appfolder/Diagrams/DiagramsOT.html" >> GetStand.desktop
			echo "Icon=$icon/GetStand.png" >> GetStand.desktop
			echo "Terminal=false" >> GetStand.desktop
			echo "Type=Application" >> GetStand.desktop
			mv /home/$userName/.local/share/applications/GetStand.desktop /home/$userName/Desktop/GetStand.desktop
			mv /home/$userName/.local/share/applications/GetStand.desktop /home/$userName/–†–∞–±–æ—á–∏–π\ —Å—Ç–æ–ª/GetStand.desktop
			zenity --info --title="GetStand" --window-icon="$icon/install.png" --ellipsize --text="–ê–∫–∫–∞—É–Ω—Ç —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω!\n–ü—Ä–∏—è—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è :)\n\n–ü–æ–¥–ø–∏—Å—ã–≤–∞–π—Ç–µ—Å—å –Ω–∞ telegram –∫–∞–Ω–∞–ª\n–ó–¥–µ—Å—å –≤—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å—Ç–µ–Ω–¥–∞—Ö\nhttps://t.me/+e8d9JjwJMtY4NzYy" --ok-label="–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å"

	fi

return 0
}

function Configures {						#–§—É–Ω–∫—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π

	if [ -e "$1$2" ]	#–ï—Å–ª–∏ —É–∂–µ –µ—Å—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è, –±–µ–∫–∞–ø–∏–º –µ—ë
	then

		mv "$1$2" "$1$2.origin.`date +%M.%S`"
		ln -s "$3" "$1$2"

	else

		mkdir "$1"			#–ï—Å–ª–∏ –Ω–µ—Ç, –ø–æ–¥—Å—Ç—Ä–∞–∏–≤–∞–µ–º –µ—ë –ø–æ–¥ —Ä–∞–±–æ—Ç—É
		ln -s "$3" "$1$2"

	fi

}





#–ü–†–û–í–ï–†–ö–ê –ü–†–ò–õ–û–ñ–ï–ù–ò–ô
for i in vnc/vncviewer kitty/putty winscp/filezilla
do

	$appfolder/App/$i --help >/dev/null 2>&1
	[ $? == 0 -o $? == 255 ] || {

		echo -e "\n–£—Ç–∏–ª–∏—Ç–∞ $i –∏–º–µ–µ—Ç –Ω–µ—Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏. –£—Å—Ç—Ä–∞–Ω–∏—Ç–µ –∏—Ö –≤—Ä—É—á–Ω—É—é.\n"
		zenity --error --title="GetStand" --ellipsize --text="–£—Ç–∏–ª–∏—Ç–∞ $i –∏–º–µ–µ—Ç –Ω–µ—Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏\n–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É—Å—Ç—Ä–∞–Ω–∏—Ç–µ –∏—Ö –≤—Ä—É—á–Ω—É—é"
		exit

	}

done



#–û–¢–†–ò–°–û–í–´–í–ê–ï–ú –û–°–ù–û–í–ù–û–ï –û–ö–ù–û –ò –î–ò–ê–õ–û–ì
while true
do

	#–û—Ç—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω–æ–µ –æ–∫–Ω–æ –≤–≤–æ–¥–∞ –¥–∞–Ω–Ω—ã—Ö
	input=`zenity --entry --title="GetStand Linux version" --window-icon="$icon/install.png" --width=320 --height=210 --ok-label="–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å" --cancel-label="–í—ã—Ö–æ–¥" --text="\t–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é –≤–∞—Å –≤ —Å–∏—Å—Ç–µ–º–µ GetStand!\n\n–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è:\n–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ —Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ\n–≤ —Å–ª–µ–¥—É—é—â–µ–º —Ñ–æ—Ä–º–∞—Ç–µ: –ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω(iva)" --entry-text="–§–∞–º–∏–ª–∏—è –ò–º—è(username)"`
		if [ $? == 0 ]
		then

			zenity --question --title="GetStand" --window-icon="$icon/install.png" --text="–ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–∏—Å—Ç–µ–º–µ GetStand?" --ellipsize --ok-label="–î–∞" --cancel-label="–ù–µ—Ç"
			[ $? == 0 ] && {

				CreateAccount			#–°–æ–∑–¥–∞–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
				[ $? == 1 ] && { continue; }
				break

			}

		else

			exit 0

		fi

done



#–ü–û–î–°–¢–†–û–ô–ö–ê –ö–û–ù–§–ò–ì–û–í
#–ü–æ–¥—Å—Ç—Ä–æ–π–∫–∞ putty
Configures "/home/$userName/.putty" "/sessions" "$appfolder/App/kitty/Sessions/linux"
#–ü–æ–¥—Å—Ç—Ä–æ–π–∫–∞ filezilla. –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥–æ–≤ –Ω–µ–º–Ω–æ–≥–æ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –Ω–∞ —Ä–∞–∑–Ω—ã—Ö –û–°—è—Ö
if [ -e "/etc/redhat-release" ]
then

	Configures "/home/$userName/.filezilla" "/sitemanager.xml" "$appfolder/App/winscp/sitemanager.xml"

else

	Configures "/home/$userName/.config/filezilla" "/sitemanager.xml" "$appfolder/App/winscp/sitemanager.xml"

fi